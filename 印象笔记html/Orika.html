<html>
<head>
  <title>Orika</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600480 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="673"/>
<h1>Orika</h1>

<div>
<span><div>1.orika是提供javabean拷贝的框架，使用只需要引入maven依赖</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;dependency&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">   &lt;groupId&gt;ma.glasnost.orika&lt;/groupId&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">   &lt;artifactId&gt;orika-core&lt;/artifactId&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">   &lt;version&gt;1.4.2&lt;/version&gt;&lt;!--或最近版本--&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;/dependency&gt;</span></div></div><div><br/></div><div><br/></div><div>2.例如将Entity拷贝为DTO</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">import ma.glasnost.orika.MapperFacade;</span></div><div><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">...</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">MapperFacade <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mapperFacade = new MapperFacade();</span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">final OrderDto orderDto = mapperFacade.map(order,orderDto.class);</span></div></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">如果有字符串与枚举类型之间的相互转化，可以使用以下办法：（参考博客</span><a href="https://www.jianshu.com/p/271cf6976a3d" style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">https://www.jianshu.com/p/271cf6976a3d</a><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">）</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">@Component</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">public class ABCSummaryMapping implements OrikaMapperFactoryConfigurer {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    @Override</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    public void configure(MapperFactory mapperFactory) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        mapperFactory.classMap(PositionSummaryPo.class, PositionSummaryDto.class)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                .field(&quot;instrumentID&quot;,&quot;contractCode&quot;)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                .field(&quot;volumnYd&quot;,&quot;volumnYestoday&quot;)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                .field(&quot;volumeTot&quot;,&quot;volumnSum&quot;)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                .field(&quot;volumnTd&quot;,&quot;volumnToday&quot;)</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                .fieldMap(&quot;hedgeType&quot;, &quot;hedgeType&quot;).converter(&quot;hedgeConvert&quot;).add()</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                .byDefault()</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                .register();</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        mapperFactory</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                .getConverterFactory()</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                .registerConverter(&quot;hedgeConvert&quot;, new BidirectionalConverter&lt;<span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">TestEnum</span>, String&gt;() {</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    @Override</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    public String convertTo(<span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">TestEnum  test</span>Enum, Type&lt;String&gt; type, MappingContext mappingContext) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        return <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">test</span><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Enum</span>.toString();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    }</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    @Override</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    public <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">TestEnum</span>convertFrom(String s, Type&lt;TestEnum&gt; type, MappingContext mappingContext) {</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                        return   <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">TestEnum</span>.getEnum(Integer.valueOf(s));</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                });</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    }</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">}</span></div></div><div><br/></div><div>3.配置特殊映射全局类</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>//全局配置映射</div><div>@Component</div><div>public class RegisterConverter implements OrikaMapperFactoryConfigurer {</div><div><br/></div><div>    @Override</div><div>    public void configure(MapperFactory mapperFactory) {</div><div>        final ConverterFactory converterFactory = mapperFactory.getConverterFactory();</div><div><br/></div><div>        final BidirectionalConverter&lt;TestEnum, Integer&gt; testConverter;</div><div>        testConverter= new BidirectionalConverter&lt;TestEnum, Integer&gt;() {</div><div>            @Override</div><div>            public Integer convertTo(TestEnum source, Type&lt;Integer&gt; destinationType, MappingContext mappingContext) {</div><div>                return source.getCode();</div><div>            }</div><div><br/></div><div>            @Override</div><div>            public TestEnum convertFrom(Integer source, Type&lt;TestEnum&gt; destinationType, MappingContext mappingContext) {</div><div>                return TestEnum.getEnum(source);</div><div>            }</div><div>        };</div><div><span>    </span><span>    </span>converterFactory.registerConverter(&quot;sys_testConverter&quot;,testConverter);</div><div><span>    </span>}</div><div>}</div><div><br/></div><div>//配置类中可直接引入</div><div>@Component</div><div>@DependsOn(&quot;registerConverter&quot;)</div><div>public class ConditionOrderMapping implements OrikaMapperFactoryConfigurer{</div><div>    @Override</div><div>    public void configure(MapperFactory mapperFactory) {</div><div>        mapperFactory.classMap(OrderRequest.class, OrderDto.class)</div><div>                .fieldMap(&quot;offline&quot;,&quot;offline&quot;).converter(&quot;sys_testConverter&quot;).add()</div><div>                .byDefault()</div><div>                .register();</div><div><span>    </span>}</div><div>}</div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><b><font style="font-size: 12pt;">4.踩坑</font></b>，当没有配置特殊映射类时，Date类型与String类型转换会失败，此时提示信息不明显</div><div><img src="Orika_files/6SKDWT2YGFAEL$5G3W{[}R6.png" type="image/png" data-filename="6SKDWT2YGFAEL$5G3W{[}R6.png"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 