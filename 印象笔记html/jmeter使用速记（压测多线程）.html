<html>
<head>
  <title>jmeter使用速记（压测多线程）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600480 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="631"/>
<h1>jmeter使用速记（压测多线程）</h1>

<div>
<span><div><div>jmeter是java开发的免安装测试工具，要求jdk环境，默认使用系统环境变量地址作为jdk路径，因此要配置环境变量，<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">jmeter3.x要求jdk版本在1.7以上</span>，jmeter4.x要求jdk版本在1.8以上，以下以jdk1.7为例</div><hr/><ol><li><div>创建线程组，测试计划中添加线程组</div></li></ol><div style="margin-left: 80px;"><img src="jmeter使用速记（压测多线程）_files/Image.png" type="image/png" data-filename="Image.png"/></div><ul><li><div>设置线程组并发</div></li></ul><div style="margin-left: 80px;"><img src="jmeter使用速记（压测多线程）_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div style="margin-left: 80px;">其中线程数不用说，Ramp-Up Period(in seconds)意为在多少秒内启动这些线程，我这里设置为同时启动，循环次数代表循环请求的次数，这里也设置为1，请求一次就行了，暂时不需要循环多次</div><div>2.准备工作完成后，开始设置请求信息，在刚刚设置的线程组上添加HTTP请求</div><div style="margin-left: 80px;"><img src="jmeter使用速记（压测多线程）_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><ul><li><div>设置请求信息</div></li></ul><div style="margin-left: 80px;"><img src="jmeter使用速记（压测多线程）_files/Image [3].png" type="image/png" data-filename="Image.png" width="1242"/></div><div>对于大部分web接口来说都要先请求第一个登录或者认证接口进行授权，然后才能继续请求其他接口，<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">服务器名称或IP</span> 就是要请求的接口的ip地址，后面<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">端口号</span>也是紧跟着路由的接口，下面HTTP请求中可以选择协议和请求方法，</div><div>请求默认是http请求，然后可以选择内容的编码格式，最后对于post请求，在<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Body Data</span>中输入要请求的参数，对于GET请求，在<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Parameters</span>中点击<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">添加</span>（未展示）添加参数</div><ul><li><div>设置HTTP请求头管理器（选读）</div></li></ul><div style="margin-left: 80px;">刚刚只是设置了http请求中的起始行或者请求参数/消息体，对于一些请求来说，还需要指定消息头的格式等信息，就要再刚刚的基础上添加<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">HTTP信息头管理器</span></div><div style="margin-left: 40px;">这里我设置Content-Type为application/json</div><div style="margin-left: 40px;"><br/></div><div><br/></div><hr/><div>3.设置全局变量，将授权的token设置到全局变量中</div><ul><li><div>正则表达式提取器，在请求上添加正则表达式提取器</div></li></ul><div style="margin-left: 80px;"><img src="jmeter使用速记（压测多线程）_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><ul><li><div>设置正则表达式提取器</div></li></ul><div style="margin-left: 80px;"><img src="jmeter使用速记（压测多线程）_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div style="margin-left: 40px;">此表达式作用是提取返回的结果，其中正则表达式</div><div style="margin-left: 40px;"><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&quot;token&quot;:&quot;(.+?)&quot;</span></div></div><div style="margin-left: 40px;"><br/></div><div style="margin-left: 40px;">经过测试可以取到如下的授权返回结果</div><div style="margin-left: 40px;"><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">{&quot;randomKey&quot;:&quot;192.168.3.140&quot;,&quot;token&quot;:&quot;eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJ4aWF5IiwiaHlpMiMyMDE4JCN0ZXN0IjoiMTkyLjE2OC4zLjE0MCIsIm1vZGUiOiJXRUIiLCJjbGllbnQiOiJRRUhKTUlZdkdYRGIiLCJleHAiOjE1NDQwMDg3NTh9.aXlBuvfP3pEk4QzYGRLupuraqU338Wf_pSrqBCEIzIL_x3-VC2gMrmGFvl4aQSyjwTlIfsgajHHulPU5Gf3Mpw&quot;}</span></div></div><ul><li><div>Bean Shell PostProcessor设置，在请求中可以添加，用它来设置全局变量</div></li></ul><div><br/></div><div style="margin-left: 80px;"><img src="jmeter使用速记（压测多线程）_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><ul><li><div>将刚刚获取的token设置到全局变量中</div></li></ul><div style="margin-left: 80px;"><img src="jmeter使用速记（压测多线程）_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div><br/><span>    <span>    此处使用的是BaseShell语法，最终的效果是拼接得到如下字符串（没有引号），将其设置到名为newToken的全局变量中</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span>Bearer <span style="color: rgb(80, 80, 80); font-family: OpenSans, Helvetica, Arial, sans-serif; font-size: 12px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJjdHBfYWRtaW4iLCJoeWkyIzIwMTgkIzA0IjoiMTI3LjAuM</span></span></div></div><div><span>    </span><span>    当需要使用替换为newToken时，用如下表达式就能把刚刚设置的全局变量值取到</span><br/></div><div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">${__property(newToken)}</span></div></div><br/></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">特别强调，以上所有步骤均有设置顺序，执行请求后也是按照添加的组件顺序从上往下来执行的，如果<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Bean Shell PostProcessor组件位置在正则表达式提取器之上，就得不到最后的结果了。</span></span></div><div><span><br/></span></div><div><span>4.查看结果树，添加查看结果树组件，可以得到请求运行后得到的反馈信息</span></div><div><span><img src="jmeter使用速记（压测多线程）_files/Image [8].png" type="image/png" data-filename="Image.png"/></span></div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 