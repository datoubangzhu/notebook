<html>
<head>
  <title>导出（Easy-poi实现）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600480 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="430"/>
<h1>导出（Easy-poi实现）</h1>

<div>
<span><div>maven添加easy-poi依赖</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">dependency</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span> </font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">groupId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">cn.afterturn</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">groupId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span></font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">artifactId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">easypoi-base</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">artifactId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span> </font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">version</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">3.1.0</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">version</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span></font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">dependency</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span> </font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">dependency</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span></font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">groupId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">cn.afterturn</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">groupId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span></font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">artifactId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">easypoi-web</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">artifactId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span> </font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">version</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">3.1.0</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">version</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span> <span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">dependency</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span></font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">dependency</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span> <span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">groupId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">cn.afterturn</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">groupId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span> </font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">artifactId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">easypoi-annotation</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">artifactId</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span> </font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">version</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">3.1.0</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">version</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span> </font></div><div><font color="#000000" face="微软雅黑" style="font-size: 9pt;"><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&lt;/</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">dependency</span><span style="font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(238, 238, 238);">&gt;</span></font></div></div><div><br/></div><div>1.接口实现：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">@GetMapping</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">&quot;export/inout&quot;</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">public</span> <span style="font-size: 9pt;">ResponseEntity</span> <span style="font-size: 9pt;">cashInOutExport</span><span style="font-size: 9pt;">(</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">@RequestParam</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">value</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;portfolios&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">required</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">false</span><span style="font-size: 9pt;">) String portfolioIdList</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">@RequestParam</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">value</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;subject_code&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">required</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">false</span><span style="font-size: 9pt;">) String subjectCode</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">@RequestParam</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">value</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;type_name&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">required</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">false</span><span style="font-size: 9pt;">) String typeName</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">@RequestParam</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">value</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;start_date&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">required</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">false</span><span style="font-size: 9pt;">) String startDate</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">@RequestParam</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">value</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;end_date&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">required</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">false</span><span style="font-size: 9pt;">) String endDate</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">@RequestParam</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">value</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;account&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">required</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">false</span><span style="font-size: 9pt;">) String accountNo</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">HttpServletResponse response</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">HttpServletRequest request</span></font></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">) {</font></span></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        final</span> <span style="font-size: 9pt;">String[] split = StrUtil.</span><span style="font-style: italic; font-size: 9pt;">split</span><span style="font-size: 9pt;">(portfolioIdList</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">StringPool.</span><span style="font-style: italic; font-size: 9pt;">COMMA</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        if</span> <span style="font-size: 9pt;">(ArrayUtil.</span><span style="font-style: italic; font-size: 9pt;">isEmpty</span><span style="font-size: 9pt;">(split)) {</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                return</span> <span style="font-size: 9pt;">ResponseEntity.</span><span style="font-style: italic; font-size: 9pt;">badRequest</span><span style="font-size: 9pt;">().body(</span><span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">投资组合参数处理异常</span><span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        }</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        List&lt;String&gt; portfolioIds = Arrays.</span><span style="font-style: italic; font-size: 9pt;">asList</span><span style="font-size: 9pt;">(split)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        List&lt;Long&gt; idsList =</span> <span style="font-size: 9pt;">new</span> <span style="font-size: 9pt;">ArrayList&lt;&gt;()</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        CollectionUtils.</span><span style="font-style: italic; font-size: 9pt;">collect</span><span style="font-size: 9pt;">(portfolioIds</span><span style="font-size: 9pt;">, new</span> <span style="font-size: 9pt;">Transformer() {</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                @Override</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                public</span> <span style="font-size: 9pt;">Object</span> <span style="font-size: 9pt;">transform</span><span style="font-size: 9pt;">(Object o) {</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                        return</span> <span style="font-size: 9pt;">Long.</span><span style="font-style: italic; font-size: 9pt;">valueOf</span><span style="font-size: 9pt;">(o.toString())</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                }</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        }</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">idsList)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        CashIoQueryDto queryInOutDto =</span> <span style="font-size: 9pt;">new</span> <span style="font-size: 9pt;">CashIoQueryDto()</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        queryInOutDto.setPortfolioIds(idsList)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        queryInOutDto.setSubjectCode(subjectCode)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        queryInOutDto.setTypeName(typeName)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        queryInOutDto.setStartDate(startDate)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        queryInOutDto.setEndDate(endDate)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        queryInOutDto.setAccountNo(accountNo)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        Workbook workbook =</span> <span style="font-size: 9pt;">null;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        try</span> <span style="font-size: 9pt;">{</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                workbook =</span> <span style="font-size: 9pt;">exportDataService</span><span style="font-size: 9pt;">.exportCashInOutList(queryInOutDto)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                if</span> <span style="font-size: 9pt;">(ObjectUtil.</span><span style="font-style: italic; font-size: 9pt;">isNotNull</span><span style="font-size: 9pt;">(workbook)) {</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                DownloadUtil.</span><span style="font-style: italic; font-size: 9pt;">downloadExcel</span><span style="font-size: 9pt;">(response</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">request</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">出入金明细</span><span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">allowOrigin</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">workbook)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        }</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        }</span> <span style="font-size: 9pt;">catch</span> <span style="font-size: 9pt;">(IOException e) {</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-style: italic; font-size: 9pt;">                log</span><span style="font-size: 9pt;">.error(</span><span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">出入金明细数据导出失败</span><span style="font-size: 9pt;">:{}&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">portfolioIdList</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">e)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                return</span> <span style="font-size: 9pt;">ResponseEntity.</span><span style="font-style: italic; font-size: 9pt;">badRequest</span><span style="font-size: 9pt;">().body(</span><span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">数据导出失败</span><span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        }</span> <span style="font-size: 9pt;">finally</span> <span style="font-size: 9pt;">{</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                IOUtils.</span><span style="font-style: italic; font-size: 9pt;">close</span><span style="font-size: 9pt;">(workbook)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        }</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        return</span> <span style="font-size: 9pt;">ResponseEntity.</span><span style="font-style: italic; font-size: 9pt;">ok</span><span style="font-size: 9pt;">().build()</span><span style="font-size: 9pt;">;</span></font><span style="color: rgb(0, 0, 0); font-family: 微软雅黑;">  </span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑"> }</font></span></div></div><div>    </div><div><br/></div><div>2.工具类封装：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#000000" face="微软雅黑">public class DownloadUtil{</font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        public static void</span> <span style="font-size: 9pt;">downloadExcel</span><span style="font-size: 9pt;">(</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                HttpServletResponse response</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                HttpServletRequest request</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                String title</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                String allowOrigin</span><span style="font-size: 9pt;">,</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                Workbook workbook</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        )</span> <span style="font-size: 9pt;">throws</span> <span style="font-size: 9pt;">IOException {</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                response.reset()</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                response.setContentType(</span><span style="font-size: 9pt;">&quot;application/vnd.ms-excel;charset=utf-8&quot;</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                String exportTitle = DateUtil.</span><span style="font-style: italic; font-size: 9pt;">format</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">new</span> <span style="font-size: 9pt;">Date()</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">DatePattern.</span><span style="font-style: italic; font-size: 9pt;">PURE_TIME_FORMAT</span><span style="font-size: 9pt;">) + title +</span> <span style="font-size: 9pt;">&quot;.xls&quot;</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                OutputStream os =</span> <span style="font-size: 9pt;">null;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        try</span> <span style="font-size: 9pt;">{</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                String agent = request.getHeader(HttpHeaders.</span><span style="font-style: italic; font-size: 9pt;">USER_AGENT</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                String enableFileName =</span> <span style="font-style: italic; font-size: 9pt;">parseAgentDownloadFIleName</span><span style="font-size: 9pt;">(exportTitle</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">agent)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                response.addHeader(HttpHeaders.</span><span style="font-style: italic; font-size: 9pt;">CONTENT_DISPOSITION</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">&quot;attachment;fileName=&quot;</span> <span style="font-size: 9pt;">+ enableFileName)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑">        </font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                //CORS</span> <span style="font-size: 9pt;">跨域问题</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                response.setHeader(</span><span style="font-size: 9pt;">&quot;Access-Control-Allow-Origin&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">allowOrigin)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                response.setHeader(</span><span style="font-size: 9pt;">&quot;Access-Control-Allow-Headers&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">&quot;*&quot;</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                response.setHeader(</span><span style="font-size: 9pt;">&quot;Access-Control-Allow-Methods&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">&quot;*&quot;</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                response.setHeader(</span><span style="font-size: 9pt;">&quot;Access-Control-Max-Age&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">&quot;3600&quot;</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                response.setHeader(</span><span style="font-size: 9pt;">&quot;Access-Control-Allow-Headers&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">&quot;x-requested-with&quot;</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                //</span> <span style="font-size: 9pt;">是否支持</span><span style="font-size: 9pt;">cookie</span><span style="font-size: 9pt;">跨域</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                response.addHeader(</span><span style="font-size: 9pt;">&quot;Access-Control-Allow-Credentials&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">&quot;true&quot;</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                os = response.getOutputStream()</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                workbook.write(os)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                os.flush()</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        }</span> <span style="font-size: 9pt;">catch</span> <span style="font-size: 9pt;">(UnsupportedEncodingException e) {</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-style: italic; font-size: 9pt;">                LOGGER</span><span style="font-size: 9pt;">.error(</span><span style="font-size: 9pt;">&quot;file name encoding has error!&quot;</span> <span style="font-size: 9pt;">+ e)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        }</span> <span style="font-size: 9pt;">finally</span> <span style="font-size: 9pt;">{</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                IoUtil.</span><span style="font-style: italic; font-size: 9pt;">close</span><span style="font-size: 9pt;">(os)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        }</span></font></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">    }</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">}</font></span></div></div><div><br/></div><div><br/></div><div>3.Serivice层接口实现类：</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">@Override</font></span></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">public</span> <span style="font-size: 9pt;">Workbook</span> <span style="font-size: 9pt;">exportCashInOutList</span><span style="font-size: 9pt;">(CashIoQueryDto cashIoDto) {</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        final</span> <span style="font-size: 9pt;">List&lt;CashIoDto&gt; cashInOutList =</span> <span style="font-size: 9pt;">cashIoService</span><span style="font-size: 9pt;">.queryCashInOutList(cashIoDto)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        List&lt;CashIoExportDto&gt; cashInOutExportDtos = Lists.</span><span style="font-style: italic; font-size: 9pt;">newArrayListWithCapacity</span><span style="font-size: 9pt;">(cashInOutList.size())</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">//需要专门建一个Excel表格Dto用来进行和数据库查询出的Dto相互转换</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        cashIoToExport(cashInOutList</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">cashInOutExportDtos)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        final</span> <span style="font-size: 9pt;">ExportParams entity =</span> <span style="font-size: 9pt;">new</span> <span style="font-size: 9pt;">ExportParams(</span><span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">出入金流水</span><span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">出入金流水信息</span><span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        return</span> <span style="font-size: 9pt;">ExcelExportUtil.</span><span style="font-style: italic; font-size: 9pt;">exportExcel</span><span style="font-size: 9pt;">(entity</span><span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">CashIoExportDto.</span><span style="font-size: 9pt;">class,</span> <span style="font-size: 9pt;">cashInOutExportDtos)</span><span style="font-size: 9pt;">;</span></font></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">}</font></span></div><div><br/></div><div><br/></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">private void</span> <span style="font-size: 9pt;">cashIoToExport</span><span style="font-size: 9pt;">(List&lt;CashIoDto&gt; cashIo </span><span style="font-size: 9pt;">, </span></font><span style="font-size: 9pt; color: rgb(0, 0, 0); font-family: 微软雅黑;">List&lt;CashIoExportDto&gt;  entrustOrderExportDtoList) {</span></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">            for</span> <span style="font-size: 9pt;">(CashIoDto cashIoDto : cashIo) {</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">            CashIoExportDto cashInOutExportDto = CashIoExportDto.</span><span style="font-style: italic; font-size: 9pt;">builder</span><span style="font-size: 9pt;">()</span></font></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">                .title(cashIoDto.getTitle())</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">                .accountName(cashIoDto.getAccountName())</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">                .totalAmountAfter(cashIoDto.getTotalAmountAfter())</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">                .totalAmountBefore(cashIoDto.getTotalAmountBefore())</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">                .income(cashIoDto.getIncome())</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">                .expenses(cashIoDto.getExpenses())</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">                .subject(cashIoDto.getSubject())</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">                .type(cashIoDto.getType())</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">                .description(cashIoDto.getDescription())</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">                .tradeDate(cashIoDto.getTradeDate())</font></span></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                .dateline(cashIoDto.getDateline()).build()</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">                entrustOrderExportDtoList.add(cashInOutExportDto)</span><span style="font-size: 9pt;">;</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">          }</span></font></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">}</font></span></div></div><div><br/></div><div><br/></div><div><br/></div><div>4.Excel用Dto，查询得到的dto不再展示</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import cn.afterturn.easypoi.excel.annotation.Excel;</div><div>import lombok.Builder;</div><div>import lombok.Data;</div><div><br/></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">@Data</font></span></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">@Builder</font></span></div><div><font style="font-family: 微软雅黑; color: rgb(0, 0, 0);"><span style="font-size: 9pt;">public class</span> <span style="font-size: 9pt;">CashIoExportDto {</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">    //@Excel注解表示要在Excel表中出现的列内容，name为列名，height和width为单元格的高度和宽度</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">投资组合名称</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">String</span> <span style="font-size: 9pt;">title</span><span style="font-size: 9pt;">;</span></font></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">（本方）资金账号名称</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">String</span> <span style="font-size: 9pt;">accountName</span><span style="font-size: 9pt;">;</span></font></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">出入金前总额</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">BigDecimal</span> <span style="font-size: 9pt;">totalAmountBefore</span><span style="font-size: 9pt;">;</span></font></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">出入金后总额</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">BigDecimal</span> <span style="font-size: 9pt;">totalAmountAfter</span><span style="font-size: 9pt;">;</span></font></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">收入</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">BigDecimal</span> <span style="font-size: 9pt;">income</span><span style="font-size: 9pt;">;</span></font></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">支出</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">BigDecimal</span> <span style="font-size: 9pt;">expenses</span><span style="font-size: 9pt;">;</span></font></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">科目</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">String</span> <span style="font-size: 9pt;">subject</span><span style="font-size: 9pt;">;</span></font></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">类型</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">String</span> <span style="font-size: 9pt;">type</span><span style="font-size: 9pt;">;</span></font></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">描述</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">String</span> <span style="font-size: 9pt;">description</span><span style="font-size: 9pt;">;</span></font></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">交易日期</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">String</span> <span style="font-size: 9pt;">tradeDate</span><span style="font-size: 9pt;">;</span></font></div><div><br/></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        @Excel</span><span style="font-size: 9pt;">(</span><span style="font-size: 9pt;">name</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">&quot;</span><span style="font-size: 9pt;">操作时间</span><span style="font-size: 9pt;">&quot;</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">height</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">8</span> <span style="font-size: 9pt;">,</span> <span style="font-size: 9pt;">width</span> <span style="font-size: 9pt;">=</span> <span style="font-size: 9pt;">18</span><span style="font-size: 9pt;">)</span></font></div><div><font color="#000000" face="微软雅黑"><span style="font-size: 9pt;">        private</span> <span style="font-size: 9pt;">String</span> <span style="font-size: 9pt;">dateline</span><span style="font-size: 9pt;">;</span></font></div><div><span style="font-size: 9pt;"><font color="#000000" face="微软雅黑">}</font></span></div></div><div><br/></div><div><br/></div><div>是否有对话框确认下载是由浏览器选择设置的</div><div><br/></div></span>
</div></body></html> 