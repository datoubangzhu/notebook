<html>
<head>
  <title>Oracle索引，存储过程，触发器，函数，序列</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600480 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="719"/>
<h1>Oracle索引，存储过程，触发器，函数，序列</h1>

<div>
<span><div><div>0.索引</div><ul><li><div>单一索引</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt;">  CREATE INDEX &quot;I2TEST&quot;.&quot;IDX_FUTURES_QUOTE_T_TRADEDAY&quot; ON &quot;I2TEST&quot;.&quot;PUB_FUTURES_QUOTE_T&quot; (&quot;TRADE_DAY&quot; DESC)</span></div></div><ul><li><div>聚集索引（待编）</div></li></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><br/></div></div><div><br/></div><div><br/></div><div><br/></div><div>1.触发器</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">create or replace TRIGGER &quot;TIB_CRC_FUNCTION&quot; BEFORE INSERT</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ON CRC_FUNCTION FOR EACH ROW</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">DECLARE</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    INTEGRITY_ERROR  EXCEPTION;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    ERRNO            INTEGER;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    ERRMSG           CHAR(200);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    DUMMY            INTEGER;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    FOUND            BOOLEAN;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">BEGIN</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    SELECT SEQ_CRC_FUNCTION_IID.NEXTVAL INTO :NEW.IID FROM DUAL;</span></div><div><br/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">EXCEPTION</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">    WHEN INTEGRITY_ERROR THEN</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">       RAISE_APPLICATION_ERROR(ERRNO, ERRMSG);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">END;</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div></div><div>//select ...  into ... from ...用法：查询到数据后插入到另外一处</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 9pt; font-family: Consolas;"><font color="#000000">//将Persons表中的数据查询后倒入到Persons_backup表中去</font></span></div><div><span style="border: 0px; font-family: Consolas, &quot;Courier New&quot;, Courier, monospace; color: rgb(0, 0, 221); font-size: 9pt;">SELECT  *</span></div><div><span style="border: 0px; font-family: Consolas, &quot;Courier New&quot;, Courier, monospace; color: rgb(0, 0, 221); font-size: 9pt;">INTO</span> <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Persons_backup</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">FROM Persons</span></div><div><span style="border: 0px; font-family: Consolas, &quot;Courier New&quot;, Courier, monospace; color: rgb(0, 0, 221); font-size: 9pt;">WHERE</span> <span style="font-family: Monaco; font-size: 9pt;">City='Beijing' </span></div></div><div><br/></div><div><br/></div><div><br/></div><div>2.存储过程</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">create or replace PROCEDURE           &quot;PROC_FUTURES_SERIAL_NUM_GEN&quot;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">--------------------------------</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">-- 名称: 根据交易日期生成报单引用所需数据</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">-- 作用: 根据报单交易日Num，拼接成报单引用</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">  CURDATE IN  INT</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">, REFNUMBER OUT INT</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">) AS PRAGMA AUTONOMOUS_TRANSACTION;  --定义为自主事务，不受其他事务提交，回滚影响</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">BEGIN</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">--根据交易日期判断是否需要初始化数据，否则直接获取最新Num值</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">INSERT INTO TC_FUTURES_SERIAL_NUMBERS(TRADYINGDAY,TDORDERNUM,LASTUPDATEDTIME )</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">SELECT CURDATE,0,GETSECONDUNIXTIMESTAMP() FROM dual WHERE NOT EXISTS(Select 1 FROM TC_FUTURES_SERIAL_NUMBERS WHERE TRADYINGDAY=CURDATE);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">UPDATE TC_FUTURES_SERIAL_NUMBERS SET  TDORDERNUM=TDORDERNUM+1,LASTUPDATEDTIME=GETSECONDUNIXTIMESTAMP() WHERE TRADYINGDAY=CURDATE;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">SELECT TDORDERNUM INTO REFNUMBER  FROM TC_FUTURES_SERIAL_NUMBERS WHERE TRADYINGDAY=CURDATE;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">COMMIT;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">EXCEPTION</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">WHEN OTHERS THEN</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">TC_FUTURE_ERROR_LOG_PROCD('41207','FUTURES TRADE GENERATE ORDERREF ERROR','','PROC_FUTURES_SERIAL_NUM_GEN');</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ROLLBACK;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">END PROC_FUTURES_SERIAL_NUM_GEN;</span></div></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">java调用存储过程</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">//获取OrderRef</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        final String settlementDay = DateTime.now().toString(DatePattern.PURE_DATE_PATTERN);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        Map&lt;String, Object&gt; orderRefParam = Maps.newHashMap();</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        orderRefParam.put(&quot;currentDay&quot;, settlementDay);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        orderRefParam.put(&quot;refSn&quot;, 0);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        baseMapper.findOrderRef(orderRefParam);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        Object orderRef = orderRefParam.get(&quot;refSn&quot;);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mapper:</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">void findOrderRef(Map&lt;String, Object&gt; orderRefParam);</span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">mapper.xml:</span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        <span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&lt;select id=&quot;findOrderRef&quot; statementType=&quot;CALLABLE&quot;&gt;</span></span></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">         &lt;![CDATA[</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">                CALL PROC_FUTURES_SERIAL_NUM_GEN(#{currentDay}, #{refSn, jdbcType=INTEGER, mode=OUT})</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        ]]&gt;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">        &lt;/select&gt;</span></div><div><br/></div></div><div><br/></div><div><br/></div><div><br/></div><div>3.函数</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">create or replace FUNCTION &quot;COMMISION_CALC&quot;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">--------------------------------</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">-- 名称: 根据开平仓操作、开平量操作计算手续费</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">-- 作用: 根据开平仓操作、开平量操作计算手续费，用作资金流水出入使用</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_OFFSET IN CHAR,                   --合约开平方向</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_TDVOLUME IN INT,                  --今仓量</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_YDVOLUME IN INT,                  --昨仓量</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_PRICE IN NUMBER,                  --交易价、结算价</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_CONTRACT_CODE IN VARCHAR2        --合约编码</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">)  RETURN NUMBER</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">IS</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">--手续费计算</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_COMMISION NUMBER(18,6):=0;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_VOLUME_MULTIPLE INT;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_OPEN_RATIO_BY_MONEY NUMBER(18,0);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_OPEN_RATIO_BY_VOLUME NUMBER(18,0);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_CLOSE_RATIO_BY_MONEY NUMBER(18,0);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_CLOSE_RATIO_BY_VOLUME NUMBER(18,0);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_CLOSE_TODAY_RATIO_BY_MONEY NUMBER(18,0);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_CLOSE_TODAY_RATIO_BY_VOLUME NUMBER(18,0);</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">BEGIN</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">SELECT A.VOLUME_MULTIPLE,B.OPEN_RATIO_BY_MONEY,B.OPEN_RATIO_BY_VOLUME,B.CLOSE_RATIO_BY_MONEY,B.CLOSE_RATIO_BY_VOLUME,B.CLOSE_TODAY_RATIO_BY_MONEY,B.CLOSE_TODAY_RATIO_BY_VOLUME</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">INTO P_VOLUME_MULTIPLE,P_OPEN_RATIO_BY_MONEY,P_OPEN_RATIO_BY_VOLUME,P_CLOSE_RATIO_BY_MONEY,P_CLOSE_RATIO_BY_VOLUME,P_CLOSE_TODAY_RATIO_BY_MONEY,P_CLOSE_TODAY_RATIO_BY_VOLUME FROM</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(SELECT * FROM PUB_BASIC_FUTURES_INFO WHERE CONTRACT_CODE=P_CONTRACT_CODE AND DELETE_FLAG=0 AND ROWNUM=1) A</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">inner join</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">(SELECT * FROM PUB_FUTURES_COMMISION WHERE DELETE_FLAG=0) B</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ON A.PRODUCT_CODE=B.CONTRACT_CODE WHERE ROWNUM=1;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">IF P_OPEN_RATIO_BY_MONEY=0 AND P_CLOSE_RATIO_BY_MONEY=0 AND P_CLOSE_TODAY_RATIO_BY_MONEY=0 THEN</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">IF P_OFFSET=0 THEN</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_COMMISION:=P_TDVOLUME*P_OPEN_RATIO_BY_VOLUME+P_YDVOLUME*P_OPEN_RATIO_BY_VOLUME;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ELSE</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_COMMISION:=P_TDVOLUME*P_CLOSE_TODAY_RATIO_BY_VOLUME+P_YDVOLUME*P_CLOSE_RATIO_BY_VOLUME;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">END IF;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ELSE</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">IF P_OFFSET=0 THEN</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_COMMISION:=(P_TDVOLUME+P_YDVOLUME)*P_VOLUME_MULTIPLE*P_OPEN_RATIO_BY_MONEY*P_PRICE;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">ELSE</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">P_COMMISION:=P_TDVOLUME*P_VOLUME_MULTIPLE*P_PRICE*P_CLOSE_TODAY_RATIO_BY_MONEY+P_YDVOLUME*P_VOLUME_MULTIPLE*P_PRICE*P_CLOSE_RATIO_BY_MONEY;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">END IF;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">END IF;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">RETURN P_COMMISION;</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">END;</span></div></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">注意函数和存储过程的区别，函数可以在select中直接调用，而存储过程不可以，调用方法比较特殊，另外业务角度来说，函数有直接的返回值并且只返回一个值</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><br/></span></div><div><br/></div><div><br/></div><div><br/></div><div>4.序列</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">CREATE SEQUENCE  &quot;I2TEST&quot;.&quot;SEQ_CASH_CHANGE_TYPE_IID&quot;  MINVALUE 1 MAXVALUE 999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 ORDER  CYCLE ;</span></div></div><div>说明：</div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">create sequence name</span></span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="font-size: 10pt; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">increment by x //x为增长间隔</span></span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">start with x //x为初始值（注意这个值随着序列的使用在不断的增加，新建时，等于重新开始使用，应该从1开始）</span></span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">maxvalue x //x为最大值</span></span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="font-size: 10pt; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">minvalue x //x为最小值</span></span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="font-size: 10pt; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">cycle //循环使用，到达最大值或者最小值时，从新建立对象</span></span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><span style="font-size: 10pt; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">cache x //制定存入缓存（也就是内存）序列值的个数</span></span></div><div><br style="content: &quot;&quot;; display: block; width: 705px; height: 0px; margin: 20px 0px; color: rgb(51, 51, 51); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"/></div><div><font style="font-size: 10pt;"><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">序列是一数据库对象，利用它可生成唯一的整数。一般使用序列自动地生成主码值。一个序列的值是由特别的</span><a href="https://www.baidu.com/s?wd=Oracle&amp;tn=SE_PcZhidaonwhc_ngpagmjz&amp;rsv_dl=gh_pc_zhidao" style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 10pt; color: rgb(63, 136, 191); font-variant-caps: normal; font-variant-ligatures: normal;">Oracle</a><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">程序自动生成。</span></font></div><div><font style="font-size: 10pt;"><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">如果不设定cycle循环的话，每一个</span><a href="https://www.baidu.com/s?wd=%E5%BA%8F%E5%88%97%E5%8F%B7&amp;tn=SE_PcZhidaonwhc_ngpagmjz&amp;rsv_dl=gh_pc_zhidao" style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 10pt; color: rgb(63, 136, 191); font-variant-caps: normal; font-variant-ligatures: normal;">序列号</a><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">是唯一的。 当一个</span><a href="https://www.baidu.com/s?wd=%E5%BA%8F%E5%88%97%E5%8F%B7&amp;tn=SE_PcZhidaonwhc_ngpagmjz&amp;rsv_dl=gh_pc_zhidao" style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 10pt; color: rgb(63, 136, 191); font-variant-caps: normal; font-variant-ligatures: normal;">序列号</a><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">生成时，序列是递增</span></font></div><div><br style="content: &quot;&quot;; display: block; width: 705px; height: 0px; margin: 20px 0px; color: rgb(51, 51, 51); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"/></div><div><font style="font-size: 10pt;"><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">当使用到序列的事务发生回滚。会造成</span><a href="https://www.baidu.com/s?wd=%E5%BA%8F%E5%88%97%E5%8F%B7&amp;tn=SE_PcZhidaonwhc_ngpagmjz&amp;rsv_dl=gh_pc_zhidao" style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 10pt; color: rgb(63, 136, 191); font-variant-caps: normal; font-variant-ligatures: normal;">序列号</a><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">不连续。</span></font></div><div><br/></div><div><font style="font-size: 10pt;"><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">cache的作用：当大量语句发生请求，申请序列时，为了避免序列在运用层实现序列而引起的性能瓶颈。</span><a href="https://www.baidu.com/s?wd=Oracle&amp;tn=SE_PcZhidaonwhc_ngpagmjz&amp;rsv_dl=gh_pc_zhidao" style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-size: 10pt; color: rgb(63, 136, 191); font-variant-caps: normal; font-variant-ligatures: normal;">Oracle</a><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 10pt; color: rgb(51, 51, 51); font-variant-caps: normal; font-variant-ligatures: normal;">序列允许将序列提前生成 cache x个先存入内存，在发生大量申请序列语句时，可直接到运行最快的内存中去得到序列。但cache个数也不能设置太大，因为在数据库重启时，会清空内存信息，预存在内存中的序列会丢失，当数据库再次启动后，序列从上次内存中最大的序列号+1 开始存入cache x个</span></font></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 